# 実装計画

- [x] 1. プロジェクト構造とコア インターフェースの設定
  - Androidライブラリプロジェクトの基本構造を作成
  - パッケージ構造とメインクラスの骨格を定義
  - _要件: 1.1, 1.2_

- [x] 2. データモデルと例外クラスの実装
  - [x] 2.1 例外クラス階層の実装
    - LzhException基底クラスとその派生例外クラスを作成
    - 各例外クラスに適切なコンストラクタとメッセージを実装
    - _要件: 7.1, 7.2, 7.3, 7.4_

  - [x] 2.2 LzhEntryとLzhArchiveモデルクラスの実装
    - ファイルエントリ情報を保持するLzhEntryクラスを作成
    - アーカイブ全体を表現するLzhArchiveクラスを実装
    - _要件: 3.3_

- [x] 3. LZHヘッダー解析機能の実装
  - [x] 3.1 基本ヘッダー解析の実装
    - バイナリヘッダーの読み取りとパース機能を実装
    - ヘッダーサイズ、圧縮方式、ファイルサイズの解析
    - _要件: 2.1, 2.2, 2.3, 2.4_

  - [x] 3.2 文字エンコーディング検出と変換の実装
    - UTF-8とShift_JISの自動検出機能を実装
    - ファイル名の適切なデコード処理
    - _要件: 9.1, 9.2, 9.3, 9.4_

- [x] 4. 解凍エンジンの実装
  - [x] 4.1 LzhDecompressor抽象クラスの実装
    - 解凍処理の基底クラスとファクトリーメソッドを作成
    - 共通的な解凍処理フローを定義
    - _要件: 5.1, 5.2, 5.3, 5.4_

  - [x] 4.2 LH0（無圧縮）解凍の実装
    - 無圧縮データの直接コピー処理を実装
    - ストリーミング処理によるメモリ効率的な転送
    - _要件: 5.1, 6.1, 6.2_

  - [x] 4.3 LH1（LZSS）解凍の実装
    - LZSS解凍アルゴリズムを実装
    - 辞書ベースの解凍処理とバッファ管理
    - _要件: 5.2, 6.1, 6.2_

  - [x] 4.4 LH5（LZSS改良版）解凍の実装
    - 改良版LZSS解凍アルゴリズムを実装
    - ハフマン符号化の処理を含む解凍機能
    - _要件: 5.3, 6.1, 6.2_

- [x] 5. ファイル管理機能の実装
  - [x] 5.1 FileManagerクラスの実装
    - 出力ディレクトリの作成と管理機能を実装
    - パストラバーサル攻撃防止のためのパス検証
    - _要件: 4.1, 4.2, 4.3_

  - [x] 5.2 Android内部ストレージ対応の実装
    - Context.getFilesDir()を使用したファイル出力
    - Android固有のファイル権限処理
    - _要件: 4.4, 8.1, 8.2_

- [x] 6. メインAPIの実装


  - [x] 6.1 LzhExtractorクラスの基本機能実装





    - ファイル、InputStream、バイト配列からの解凍メソッドを実装
    - 入力ソースの検証と適切な例外処理
    - _要件: 1.2, 2.1, 2.2, 2.3, 2.4_

  - [x] 6.2 アーカイブ情報取得機能の実装




    - アーカイブ内容のリスト表示機能を実装
    - ファイルメタデータの取得と表示
    - _要件: 3.3, 3.4_
  - [x] 6.3 個別ファイル抽出機能の実装







  - [ ] 6.3 個別ファイル抽出機能の実装

    - 指定されたファイル名による個別抽出機能を実装
    - ファイルが存在しない場合のエラーハンドリング
    - _要件: 3.1, 3.2, 3.4_
-

- [x] 7. 統合とエラーハンドリングの完成



  - [x] 7.1 包括的なエラーハンドリングの実装







    - 全ての例外ケースに対する適切な処理を実装
    - 詳細なエラーメッセージとログ出力機能
    - _要件: 7.1, 7.2, 7.3, 7.4_
-

  - [x] 7.2 Android互換性の最終確認と調整






    - API 21以上での動作確認とバグ修正
    - ProGuard設定とビルド構成の最適化
    - _要件: 8.1, 8.2, 8.3, 8.4_

- [x] 8. テストケースの実装





  - [x] 8.1 単体テストの作成



    - 各コンポーネントの単体テストを作成
    - モックを使用した独立したテスト環境の構築
    - _要件: 全要件_

  - [x] 8.2 統合テストの作成



    - 実際のLZHファイルを使用した統合テストを作成
    - 様々なシナリオでの動作確認テスト
    - _要件: 全要件_

  - [x] 8.3 Android環境テストの作成



    - Android実機での動作確認テストを作成
    - 異なるAPIレベルでの互換性テスト
    - _要件: 8.1, 8.2, 8.3, 8.4_